<ion-header>
  <ion-toolbar>
    <ion-title class="font2P">Checkout</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">

  <div *ngIf="savedCard" class="saved-card-checkout">
    <div class="checkout-card">
      <div class="checkout-card-logo">
        <img *ngIf="savedCard.brand === 'visa'" src="https://upload.wikimedia.org/wikipedia/commons/0/04/Visa.svg" />
        <img *ngIf="savedCard.brand === 'mastercard'" src="https://img.icons8.com/color/48/mastercard-logo.png" />
      </div>

      <div class="checkout-card-number">
        {{ savedCard.number ? (savedCard.number | slice:0:4) + ' ' +
        (savedCard.number | slice:4:8) + ' ' +
        (savedCard.number | slice:8:12) + ' ' +
        (savedCard.number | slice:12) : '**** **** **** ****' }}
      </div>

      <div class="checkout-card-footer">
        <div class="holder">{{ savedCard.holder?.toUpperCase() || 'NOMBRE Y APELLIDO' }}</div>
        <div class="expiry">{{ savedCard.expiry || 'MM/AA' }}</div>
      </div>
    </div>
  </div>



  <div class="method-cards">
    <div class="method-card" [class.selected]="selectedMethod === 'card'" (click)="selectMethod('card')">
      <ion-icon name="card-outline"></ion-icon>
      <span>Add card</span>
    </div>

    <div class="method-card" [class.selected]="selectedMethod === 'yappy'" (click)="selectMethod('yappy')">
      <img src="https://ganoitouchpanama.com/wp-content/uploads/2021/07/yappy-logo-landing.png" alt="Yappy" />
      <span>Yappy</span>
    </div>
  </div>




  <div class="summary-card">
    <h2 class="summary-title">Resumen de compra</h2>

    <div class="summary-row">
      <span class="summary-label">Productos</span>
      <span class="summary-value">{{ cartItems.length }}</span>
    </div>

    <div class="summary-row">
      <span class="summary-label">Subtotal</span>
      <span class="summary-value">${{subtotal.toFixed(2)}}</span>
    </div>

    <div class="summary-row">
      <span class="summary-label">Total redondeado</span>
      <span class="summary-value">${{ roundedTotal.toFixed(2) }}</span>
    </div>

    <div class="summary-row" *ngIf="savings > 0">
      <span class="summary-label">Ahorro</span>
      <span class="summary-value discount">${{ savings.toFixed(2) }}</span>
    </div>

    <div class="divider"></div>

    <div class="summary-row total">
      <span class="summary-label">Total</span>
      <span class="summary-value">${{ finalTotal.toFixed(2) }}</span>
    </div>

    <ion-button expand="block" class="pay-button" (click)="payNow()">
      Pay Now
    </ion-button>
  </div>


</ion-content>



<app-tabs-pages></app-tabs-pages>